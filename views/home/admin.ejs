<div class="container" id="deliveryStats">

  <div class="row">
    <h1>
    	<a href="/"><%= __('Home') %></a> / 
    	<a href="/admin"><%= __('Admin') %></a>
    </h1>
  </div>


	<div class="row">
		<div class="col-md-6">
			<form id="queryForm" class="form">
				<div class="form-group">
					<label for="query">Custom query</label>
					<textarea class="form-control" rows="5" id="query"></textarea>
				</div>
				<button type="submit" class="btn btn-primary">Submit</button>

			</form>
		</div>
	</div>


	<div class="row">
		<div class="col-sm-12">
			<br/>
			<pre id="log"></pre>
		</div>
	</div>

</div>


<script type="text/javascript">
window.addEventListener('load', function () {

	var $log = $('#log');




	$('#queryForm').on('submit', function (e) {
		e.preventDefault();
		var query = $('#query').val();

		$('body').addClass('loading');
		var confirm = new WindowConfirm();
		confirm.setMessage('.admin-query-confirm', {
			query: query,
		})
		confirm.setConfirm(function () {
			socket.post('/admin/query', { query: query }, function (message) {
				if (message !== null && message.code) {
					return $log.html(syntaxHighlight(message));
				}
				if (message == null) {
					return $log.html('query executed');
				}
				$log.html(syntaxHighlight(message));
				$('body').removeClass('loading');
			});	
		});
		return confirm.show();
	})






})
</script>